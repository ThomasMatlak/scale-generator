<!DOCTYPE html>
<html>
    <head>
        <title>Scale Generator</title>
    </head>
    <body>
        <noscript>
            <h1>This page will not function when Javascript is disabled.</h1>
        </noscript>
        <form>
            <fieldset id="tonic">
                <legend>Tonic</legend>

                <input type="checkbox" id="Cb" name="Cb" checked>
                <label for="Cb">C&#9837;</label>
                <input type="checkbox" id="C" name="C" checked>
                <label for="C">C</label>
                <input type="checkbox" id="C#" name="C#" checked>
                <label for="C#">C&#9839;</label>
                <input type="checkbox" id="Db" name="Db" checked>
                <label for="Db">D&#9837;</label>
                <input type="checkbox" id="D" name="D" checked>
                <label for="D">D</label>
                <input type="checkbox" id="Eb" name="Eb" checked>
                <label for="Eb">E&#9837;</label>
                <input type="checkbox" id="E" name="E" checked>
                <label for="E">E</label>
                <input type="checkbox" id="F" name="F" checked>
                <label for="F">F</label>
                <input type="checkbox" id="F#" name="F#" checked>
                <label for="F#">F&#9839;</label>
                <input type="checkbox" id="G" name="G" checked>
                <label for="G">G</label>
                <input type="checkbox" id="Ab" name="Ab" checked>
                <label for="Ab">A&#9837;</label>
                <input type="checkbox" id="A" name="A" checked>
                <label for="A">A</label>
                <input type="checkbox" id="Bb" name="Bb" checked>
                <label for="Bb">B&#9837;</label>
                <input type="checkbox" id="B" name="B" checked>
                <label for="B">B</label>
            </fieldset>

            <fieldset id="mode">
                <legend>Mode</legend>

                <input type="checkbox" id="ionian" name="Ionian" checked>
                <label for="ionian">Ionian (major)</label>
                <input type="checkbox" id="dorian" name="Dorian">
                <label for="dorian">Dorian</label>
                <input type="checkbox" id="phrygian" name="Phrygian">
                <label for="phrygian">Phrygian</label>
                <input type="checkbox" id="lydian" name="Lydian">
                <label for="lydian">Lydian</label>
                <input type="checkbox" id="mixolydian" name="Mixolydian">
                <label for="mixolydian">Mixolydian</label>
                <input type="checkbox" id="aeolian" name="Aeolian" checked>
                <label for="aeolian">Aeolian (natural minor)</label>
                <input type="checkbox" id="locrian" name="Locrian">
                <label for="locrian">Locrian</label>
            </fieldset>

            <fieldset id="minor-variations">
                <!-- todo only let appear if aeolian is checked -->
                <legend>Minor Scale Variations (if applicable)</legend>

                <input type="checkbox" id="natural" name="Natural" checked>
                <label for="natural">Natural</label>
                <input type="checkbox" id="harmonic" name="Harmonic">
                <label for="harmonic">Harmonic</label>
                <input type="checkbox" id="melodic" name="Melodic">
                <label for="melodic">Melodic</label>
            </fieldset>

            <button type="button" id="button" onclick="chooseScale()">Give Me a Random Scale!</button>
        </form>

        <h1 id="result"></h1>

        <script>
            function randomArrayItem(arr) {
                return arr[Math.floor(Math.random() * arr.length)];
            }

            function chooseScale() {
                var tonicOptions = [];
                var modeOptions = [];

                var fields = document.getElementById("tonic").getElementsByTagName("input");
                for (var i = 0; i < fields.length; ++i) {
                    if (fields[i].checked) {
                        tonicOptions.push(fields[i].name);
                    }
                }

                fields = document.getElementById("mode").getElementsByTagName("input");
                for (var i = 0; i < fields.length; ++i) {
                    if (fields[i].checked) {
                        modeOptions.push(fields[i].name);
                    }
                }

                let tonic = randomArrayItem(tonicOptions);

                if (tonic.endsWith('#')) {
                    tonic = tonic.replace('#', '&#9839;');
                }
                else if (tonic.endsWith('b')) {
                    tonic = tonic.replace('b', '&#9837;');
                }

                let mode = randomArrayItem(modeOptions);

                if (mode == 'Ionian') {
                    mode += ' (major)';
                }
                else if (mode == 'Aeolian') {
                    var minorVariationOptions = [];

                    fields = document.getElementById("minor-variations").getElementsByTagName("input");
                    for (var i = 0; i < fields.length; ++i) {
                        if (fields[i].checked) {
                            minorVariationOptions.push(fields[i].name);
                        }
                    }

                    mode = randomArrayItem(minorVariationOptions) + ' Minor'
                }

                document.getElementById("result").innerHTML = tonic + ' ' + mode;
            }
        </script>
    </body>
</html>